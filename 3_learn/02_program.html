<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Script / Program Organization &mdash; Linux Shell Script Programming 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/aaltsys.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Linux Shell Script Programming 1.0 documentation" href="index.html" />
    <link rel="next" title="Shell Scripting Exercise" href="03_lesson1.html" />
    <link rel="prev" title="Meet the Linux Shell" href="01_shell.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="03_lesson1.html" title="Shell Scripting Exercise"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="01_shell.html" title="Meet the Linux Shell"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Linux Shell Script Programming 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Script / Program Organization</a><ul>
<li><a class="reference internal" href="#declarations-go-first">Declarations Go First</a><ul>
<li><a class="reference internal" href="#declare-the-program-language">Declare the program language</a></li>
<li><a class="reference internal" href="#assign-variables-before-use">Assign variables before use</a></li>
<li><a class="reference internal" href="#assign-script-parameters">Assign script parameters</a></li>
<li><a class="reference internal" href="#define-subroutine-sections">Define subroutine sections</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-program-or-script-body">The Program or Script Body</a></li>
<li><a class="reference internal" href="#comprehensible-scripts">Comprehensible Scripts</a><ul>
<li><a class="reference internal" href="#embed-documentation-comments">Embed documentation comments</a></li>
<li><a class="reference internal" href="#display-results">Display results</a></li>
<li><a class="reference internal" href="#inputs-and-logic-tests">Inputs and Logic tests</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="01_shell.html"
                        title="previous chapter">Meet the Linux Shell</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="03_lesson1.html"
                        title="next chapter">Shell Scripting Exercise</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/02_program.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="script-program-organization">
<span id="overview"></span><h1>Script / Program Organization<a class="headerlink" href="#script-program-organization" title="Permalink to this headline">¶</a></h1>
<p>This article ignores logical proofs regarding the nature of
<a class="reference external" href="http://en.wikipedia.org/wiki/Structured_programming">structured programming</a>,
and research into object-oriented development. Instead, program design is
presented here as a hueristic: organize your work to look a certain way, and
others will be able to understand what you have done.</p>
<p>Beyond the unique purpose of each program, all programs can share a consistent
overall layout. Further, each independent section of a master program can use
this same design logic. Along the way, warnings introduce safety rules to prevent
system programming from going awry. Tips describe good programming practice to
generalize code so it will be reuseable. Sidebars present code examples which
can be modified to build your own scripts.</p>
<div class="section" id="declarations-go-first">
<h2>Declarations Go First<a class="headerlink" href="#declarations-go-first" title="Permalink to this headline">¶</a></h2>
<div class="section" id="declare-the-program-language">
<h3>Declare the program language<a class="headerlink" href="#declare-the-program-language" title="Permalink to this headline">¶</a></h3>
<div class="sidebar">
<p class="first sidebar-title">Program declaration</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="c">#! /bin/sh</span>
<span class="c"># This program sets video resolution ...</span>
</pre></div>
</div>
</div>
<p>Head each script with a declaration, followed by comments describing the
program&#8217;s purpose.</p>
<p>For a shell program to be executed by name, the file permissions executable bit
must be set and the script must start with a &#8220;she-bang&#8221; (<tt class="docutils literal"><span class="pre">#!</span> <span class="pre">...</span></tt>) directive
naming the executable shell. (Scripts lacking these requirements can still be
executed by calling the shell interpreter directly and passing the script name
as a parameter, as in <tt class="docutils literal"><span class="pre">bash</span> <span class="pre">myscript</span> <span class="pre">parameters</span></tt>.)</p>
</div>
<div class="section" id="assign-variables-before-use">
<h3>Assign variables before use<a class="headerlink" href="#assign-variables-before-use" title="Permalink to this headline">¶</a></h3>
<div class="sidebar">
<p class="first sidebar-title">Variable initialization</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">DIR_STATIC</span><span class="o">=</span><span class="s">&#39;_static&#39;</span>
<span class="n">MAKE_METHOD</span><span class="o">=</span><span class="s">&#39;html&#39;</span>
<span class="n">GITHUB</span><span class="o">=</span><span class="s">&#39;gh-pages&#39;</span>
<span class="n">HEROKU</span><span class="o">=</span><span class="s">&#39;master&#39;</span>
<span class="n">NODEPLOY</span><span class="o">=</span><span class="s">&#39;&#39;</span>
</pre></div>
</div>
</div>
<p>Initialize all variables at the top of a script by assigning each variable a
default value or a null. The form of an assignment statement is the name of the
variable immediately followed by an equals sign (=), and then followed by a
quoted value. No space is allowed between the name and =.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">By convention, script variables commonly use uppercase. Linux commands and
other syntax are written in lowercase, as defined in the system. Linux is
entirely case-sensitive, making variable <tt class="docutils literal"><span class="pre">HEROKU</span></tt> different from variable
<tt class="docutils literal"><span class="pre">Heroku</span></tt>.</p>
</div>
</div>
<div class="section" id="assign-script-parameters">
<h3>Assign script parameters<a class="headerlink" href="#assign-script-parameters" title="Permalink to this headline">¶</a></h3>
<div class="sidebar">
<p class="first sidebar-title">Parameter assignment</p>
<div class="last highlight-python"><div class="highlight"><pre>PROJECT=&#39;default&#39;
if [ $1 != &#39;&#39; ] ; then
  PROJECT=$1
fi
</pre></div>
</div>
</div>
<p>Assign command parameters to named variables, provided the parameters are being
passed. Notice that variables are assigned by name with an <tt class="docutils literal"><span class="pre">=</span></tt> suffixed, but
a variable is evaluated by prefixing the name with a dollar sign (<tt class="docutils literal"><span class="pre">$</span></tt>).</p>
<p>Scripts receive command line parameters as variables numbered <tt class="docutils literal"><span class="pre">1</span></tt> through
<tt class="docutils literal"><span class="pre">n</span></tt>, passed by value to the script. This means that position matters. For
instance, a script expecting 2 or 3 parameters, with a default value for the
third parameter, should test to see that <tt class="docutils literal"><span class="pre">$2</span></tt> has a value before proceeding.</p>
</div>
<div class="section" id="define-subroutine-sections">
<h3>Define subroutine sections<a class="headerlink" href="#define-subroutine-sections" title="Permalink to this headline">¶</a></h3>
<div class="sidebar">
<p class="first sidebar-title">Defining subroutines</p>
<div class="last highlight-python"><div class="highlight"><pre>makedeployment() {
  make clean $MAKE_METHOD BUILDDIR=$DIR_BUILD
  cp -R $DIR_BUILD/$MAKE_METHOD/* $DIR_OUT/
  if [[ -d $DIR_DOWNLOADS ]] ; then
    cp -R $DIR_DOWNLOADS $DIR_OUT/
  fi
}
</pre></div>
</div>
</div>
<p>Code which may be executed repeatedly in a program, with each execution
differing only by assigned values, should be placed in subroutines.</p>
<p>As the example shows, variables are global and pass by name to subroutines.
A subroutine is declared with a name followed by empty parentheses <tt class="docutils literal"><span class="pre">()</span></tt>. The
commands for the subroutine is then listed enclosed in braces <tt class="docutils literal"><span class="pre">{}</span></tt>. A
subroutine is called by using its name as a command.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Place subroutines after variables are declared and assigned but before any
other code which might call them.</p>
</div>
</div>
</div>
<div class="section" id="the-program-or-script-body">
<h2>The Program or Script Body<a class="headerlink" href="#the-program-or-script-body" title="Permalink to this headline">¶</a></h2>
<p>The main body of a program should contain commands and logic to achieve the
program purpose. Short scripts may have only a main section, but a typical
script would have variable declarations and subroutines ahead of the main event.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Programs which make important changes, say altering system configuration,
should start by asking the user to confirm the change.</p>
</div>
<p>The main body of a program should end with an exit section which tells the user
what the script has done.</p>
</div>
<div class="section" id="comprehensible-scripts">
<h2>Comprehensible Scripts<a class="headerlink" href="#comprehensible-scripts" title="Permalink to this headline">¶</a></h2>
<p>Programming syntax seems obfuscatory by design, and it is the programmer&#8217;s duty
to clarify her work through comments and messages.</p>
<div class="section" id="embed-documentation-comments">
<h3>Embed documentation comments<a class="headerlink" href="#embed-documentation-comments" title="Permalink to this headline">¶</a></h3>
<div class="sidebar">
<p class="first sidebar-title">Comments</p>
<div class="last highlight-python"><div class="highlight"><pre># Makedeployment creates _build contents
makedeployment() {
  make clean $MAKE_METHOD BUILDDIR=$DIR_BUILD
  cp -R $DIR_BUILD/$MAKE_METHOD/* $DIR_OUT/

  # add download files provided they exist
  if [[ -d $DIR_DOWNLOADS ]] ; then
    cp -R $DIR_DOWNLOADS $DIR_OUT/
  fi
}
</pre></div>
</div>
</div>
<p>If the first non-whitespace character in a statement is the hash mark (<tt class="docutils literal"><span class="pre">#</span></tt>),
then the statement is a comment and is not interpreted. Use code comments to:</p>
<ul class="simple">
<li>explain the purpose of a particular command or code section</li>
<li>provide example values and results for testing</li>
<li>include notes on program purpose and practice</li>
<li>retain disabled command alternatives when testing code during programming</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">A good way to write scripts is to begin by writing only comments. Then, fill
in code to achieve the functionality described in the comments.</p>
</div>
</div>
<div class="section" id="display-results">
<h3>Display results<a class="headerlink" href="#display-results" title="Permalink to this headline">¶</a></h3>
<div class="sidebar">
<p class="first sidebar-title">Echo results</p>
<div class="last highlight-python"><div class="highlight"><pre>if [[ ! -d $PROJECT ]] ; then
  echo &quot;No Project folder \&quot;$PROJECT\&quot;. Exiting ... &quot;
  exit 1
fi
</pre></div>
</div>
</div>
<p>Use echo commands to display text on an output device, typically on the console
monitor.</p>
<p>Echo a result to document every exit point of the script or program. Similarly,
when writing a program, generate every exit condition to verify that exit
behavior is working correctly.</p>
<p>Routines which change data on disk, such as modifying file permissions or
deleting files, must be tested thoroughly before publishing the script.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">To test a script while programming: for each command which will write data,
comment out the actual command and add a statement to echo the results to the
display instead. Once the script behavior is tested and verified, uncomment
the writing commands and comment out the echo statements.</p>
</div>
</div>
<div class="section" id="inputs-and-logic-tests">
<h3>Inputs and Logic tests<a class="headerlink" href="#inputs-and-logic-tests" title="Permalink to this headline">¶</a></h3>
<div class="sidebar">
<p class="first sidebar-title">Logic tests</p>
<div class="last highlight-python"><div class="highlight"><pre>echo -e &quot;\e[1;31m Install apt-fast?&quot;
read -n 1 -p &quot;(y/n)&quot; RESP
echo -e &quot;\e[0m&quot;
if [ &quot;$RESP&quot; != &#39;y&#39; ]; then
  echo -e &quot;\nCanceled&quot;
  exit 1
fi
</pre></div>
</div>
</div>
<p>Use a read statement to get a single user response at the command line. This is
most useful to get a confirmation whenever a script will permanently effect a
system .</p>
<p>Test all possible responses to prevent erroneous or redundant script execution.
In the sidebar example, any input other than <tt class="kbd docutils literal"><span class="pre">y</span></tt> will cause the script to
exit. If the script had been written to exit on <tt class="kbd docutils literal"><span class="pre">n</span></tt>, then any key other
than <tt class="kbd docutils literal"><span class="pre">n</span></tt> would result in executing the script.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">It may seem obvious, but logic errors are very common when multiple responses
or numeric options are used, and a <strong class="command">case</strong> statement processes the
input.</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="03_lesson1.html" title="Shell Scripting Exercise"
             >next</a></li>
        <li class="right" >
          <a href="01_shell.html" title="Meet the Linux Shell"
             >previous</a> |</li>
        <li><a href="index.html">Linux Shell Script Programming 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Gerald Lovel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>