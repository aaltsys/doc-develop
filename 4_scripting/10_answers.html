<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Lesson Sample Scripts &mdash; Linux Shell Script Programming 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/aaltsys.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Linux Shell Script Programming 1.0 documentation" href="index.html" />
    <link rel="prev" title="Exercise 3: Automation Script" href="07_lesson3.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="07_lesson3.html" title="Exercise 3: Automation Script"
             accesskey="P">previous</a></li>
        <li><a href="index.html">Linux Shell Script Programming 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Lesson Sample Scripts</a><ul>
<li><a class="reference internal" href="#example-program-outline">Example Program Outline</a></li>
<li><a class="reference internal" href="#sample-hello-world-script">Sample Hello World! Script</a></li>
<li><a class="reference internal" href="#sample-expressions-script">Sample Expressions Script</a></li>
<li><a class="reference internal" href="#sample-logic-control-script">Sample Logic Control Script</a></li>
<li><a class="reference internal" href="#sample-installer-script">Sample Installer Script</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="07_lesson3.html"
                        title="previous chapter">Exercise 3: Automation Script</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/10_answers.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="lesson-sample-scripts">
<span id="answers"></span><h1>Lesson Sample Scripts<a class="headerlink" href="#lesson-sample-scripts" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Commands which produced wrong output on the target Ubuntu system have been
commented out, but are left in place for instruction and reference.</p>
</div>
<div class="section" id="example-program-outline">
<span id="hello-answers"></span><h2>Example Program Outline<a class="headerlink" href="#example-program-outline" title="Permalink to this headline">¶</a></h2>
<p>Download an example script outline <a class="reference download internal" href="_downloads/example.sh"><tt class="xref download docutils literal"><span class="pre">here</span></tt></a>,
as organized in this guide, or just view the code below.</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#! /bin/sh</span>
<span class="c"># Describe program&#39;s principal objective</span>
<span class="c"># </span>
<span class="c"># Initialize variables</span>
<span class="c"># </span>
<span class="c"># Assign parameters ($n) to named variables</span>
<span class="c"># </span>
<span class="c"># User execution confirmation (location varies)</span>
<span class="c"># </span>
<span class="c"># Declare repeated code functions</span>
<span class="c"># </span>
<span class="c"># !! MAIN SECTION !!</span>
<span class="c"># </span>
<span class="c"># Validity tests (setting exit status)</span>
<span class="c"># </span>
<span class="c"># Main code, if Valid</span>
<span class="c"># </span>
<span class="c"># Exit section: echo results, log errors</span>
<span class="c"># </span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="sample-hello-world-script">
<h2>Sample Hello World! Script<a class="headerlink" href="#sample-hello-world-script" title="Permalink to this headline">¶</a></h2>
<p>Download a sample script answering the Hello World challenge of Lesson 1
<a class="reference download internal" href="_downloads/hello-world.sh"><tt class="xref download docutils literal"><span class="pre">here</span></tt></a>, or just view the code below.</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#! /bin/bash</span>
<span class="c"># My first script, presenting programming to the world</span>
<span class="c"># </span>
<span class="c"># Initialize variables</span>
<span class="nv">DISPLAY</span><span class="o">=</span><span class="s1">&#39;World&#39;</span>
<span class="nv">EXIT</span><span class="o">=</span><span class="s1">&#39;0&#39;</span>
<span class="nv">RESP</span><span class="o">=</span><span class="s1">&#39;n&#39;</span>
<span class="c"># </span>
<span class="c"># Assign parameters ($n) to named variables</span>
<span class="c"># if [$1 != &#39;&#39;]      ; # fails without spaces around [ ]</span>
<span class="c"># if [ $1 != &#39;&#39; ]    ; # works with !# and single [ ]</span>
<span class="c"># if [ ! $1 == &#39;&#39; ]  ; # works to (!) negate the expression</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$1</span> !<span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="o">]]</span>    ; <span class="c"># works w/ single [ and double [[ </span>
<span class="k">then </span><span class="nv">DISPLAY</span><span class="o">=</span><span class="nv">$1</span>
<span class="k">fi</span>
<span class="c"># </span>
<span class="c"># User execution confirmation (location varies)</span>
<span class="c"># echo &quot;Say Hello?&quot; </span>
<span class="c"># echo &quot;\n\e[1;31m Say Hello?&quot;</span>
<span class="nb">echo</span> -e -n <span class="s1">&#39;\n\e[1;31m Say Hello&#39;</span>
<span class="nb">read</span> -n 1 -p <span class="s1">&#39; (y/n)?&#39;</span> RESP 
<span class="nb">echo</span> -e <span class="s1">&#39;\e[0m&#39;</span>
<span class="k">case</span> <span class="nv">$RESP</span> in
  y|Y<span class="o">)</span>
    <span class="nv">EXIT</span><span class="o">=</span><span class="s1">&#39;0&#39;</span> ;;
  n|N<span class="o">)</span>
    <span class="nv">EXIT</span><span class="o">=</span><span class="s1">&#39;1&#39;</span> ;;
  *<span class="o">)</span>
    <span class="nv">EXIT</span><span class="o">=</span><span class="s1">&#39;2&#39;</span> ;;
<span class="k">esac</span>
<span class="c"># </span>
<span class="c"># Declare repeated code functions (none declared)</span>
<span class="c"># </span>
<span class="c"># !! MAIN SECTION !!</span>
<span class="c"># </span>
<span class="c"># Validity tests (setting exit status)</span>
<span class="c"># </span>
<span class="c"># Main code, if Valid</span>
<span class="c"># </span>
<span class="c"># Exit section: echo results, log errors</span>
<span class="c"># echo &#39;Hello World&#39;</span>
<span class="c"># echo &#39;Hello DISPLAY&#39;  ; # full quoting</span>
<span class="c"># echo &quot;hello DISPLAY&quot;  ; # partial quoting</span>
<span class="c"># echo &#39;Hello $DISPLAY&#39; ; # $-operator for evaluation</span>
<span class="c"># echo &quot;Hello $DISPLAY&quot; ; # $ evaluation in partial quotes</span>

<span class="c"># exit statements with user message display</span>
<span class="k">case</span> <span class="nv">$EXIT</span> in
  <span class="s1">&#39;0&#39;</span> <span class="o">)</span>
    <span class="c"># echo -e &quot;\nHello $DISPLAY&quot; ;;</span>
    <span class="nb">echo</span> -e <span class="s2">&quot;\n\e[1;32m Hello $DISPLAY \e[0m\n&quot;</span> ;;
  * <span class="o">)</span>
    <span class="c"># echo -e &quot;\nCanceled&quot; ;;</span>
    <span class="nb">echo</span> -e <span class="s2">&quot;\n\e[1;31m Canceled \e[0m\n&quot;</span> ;;
<span class="k">esac</span>

<span class="nb">exit</span> <span class="nv">$EXIT</span>
<span class="c"># </span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="sample-expressions-script">
<span id="expressions-answers"></span><h2>Sample Expressions Script<a class="headerlink" href="#sample-expressions-script" title="Permalink to this headline">¶</a></h2>
<p>Download a sample script answering the expressions topics from Lesson 2
<a class="reference download internal" href="_downloads/expressions.sh"><tt class="xref download docutils literal"><span class="pre">here</span></tt></a>, or just view the code below.</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="c"># Describe program&#39;s principal objective</span>
<span class="c"># </span>
<span class="c"># Initialize variables</span>
<span class="c"># </span>
<span class="c">#</span>
<span class="c"># Assign parameters ($n) to named variables</span>
<span class="c"># </span>
<span class="c"># User execution confirmation (location varies)</span>
<span class="c"># </span>
<span class="c"># Declare repeated code functions</span>
<span class="c"># </span>
<span class="c"># !! MAIN SECTION !!</span>
<span class="c"># </span>
<span class="c"># Validity tests (setting exit status)</span>
<span class="c"># </span>
<span class="nb">echo</span>
<span class="nb">echo test </span>variable expansion in quotes
<span class="c">#</span>
<span class="nv">COMMAND</span><span class="o">=</span><span class="s1">&#39;git branch -a&#39;</span>
<span class="nb">echo</span> <span class="nv">$COMMAND</span>
<span class="c"># echo &#39;$COMMAND&#39;</span>
<span class="nb">echo</span> <span class="s2">&quot;$COMMAND&quot;</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo test command </span>execution in parentheses
<span class="c">#</span>
<span class="nv">COMMAND</span><span class="o">=</span><span class="s1">&#39;git branch -a&#39;</span>
<span class="c"># echo $( &quot;$COMMAND&quot; )</span>
<span class="k">$(</span> <span class="nb">echo</span> <span class="nv">$COMMAND</span> <span class="k">)</span>
<span class="c"># $( echo &#39;$COMMAND&#39; )</span>
<span class="k">$(</span> <span class="nb">echo</span> <span class="s2">&quot;$COMMAND&quot;</span> <span class="k">)</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo test command </span>list in parentheses
<span class="c">#</span>
<span class="nv">TEXT</span><span class="o">=</span><span class="s1">&#39;embedded grouped commands&#39;</span>
<span class="c"># echo -e $(</span>
<span class="c">#   &#39;\e[32m These statements test&#39;</span>
<span class="c">#   &quot; $TEXT. \e[0m&quot;</span>
<span class="c"># )</span>
<span class="c">#</span>
<span class="c"># $(</span>
<span class="c">#   echo -e &quot;\e[31m These statements test&quot;</span>
<span class="c">#   echo -e &quot; $TEXT. \e[0m&quot;</span>
<span class="c"># )</span>
<span class="c">#</span>
<span class="nb">echo</span> -e <span class="k">$(</span>
  <span class="nb">echo</span> <span class="s1">&#39;\e[32m These statements test&#39;</span>
  <span class="nb">echo</span> <span class="s2">&quot; $TEXT. \e[0m&quot;</span>
<span class="k">)</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo test command </span>group anonymous <span class="k">function</span>
<span class="c">#</span>
<span class="nv">TEXT</span><span class="o">=</span><span class="s1">&#39;an embedded anonymous function&#39;</span>
<span class="c"># echo -e ${ </span>
<span class="c">#   echo &#39;\e[32m These statements test&#39;</span>
<span class="c">#   echo &quot; $TEXT. \e[0m&quot; </span>
<span class="c"># }</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s1">&#39;test an integer calculation&#39;</span>
<span class="c">#</span>
<span class="nv">SEVEN</span><span class="o">=</span>7
<span class="nv">FIVE</span><span class="o">=</span>5
<span class="c"># echo -e &#39;\e[32m $FIVE times $SEVEN is $(( FIVE * SEVEN )) \e[0m&#39;</span>
<span class="nb">echo</span> -e <span class="s2">&quot;\e[32m $FIVE times $SEVEN is $(( FIVE * SEVEN )) \e[0m&quot;</span>
<span class="c"># </span>
<span class="c"># Main code, if Valid</span>
<span class="c"># </span>
<span class="c"># </span>
<span class="c"># Exit section: echo results, log errors</span>
<span class="c"># </span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="sample-logic-control-script">
<span id="logic-answers"></span><h2>Sample Logic Control Script<a class="headerlink" href="#sample-logic-control-script" title="Permalink to this headline">¶</a></h2>
<p>Download a sample script answering the Lesson 2 logic control topics
<a class="reference download internal" href="_downloads/logic-control.sh"><tt class="xref download docutils literal"><span class="pre">here</span></tt></a>, or just view the code below.</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="c"># Describe program&#39;s principal objective</span>
<span class="c"># </span>
<span class="c"># Initialize variables</span>
<span class="c"># </span>
<span class="c">#</span>
<span class="c"># Assign parameters ($n) to named variables</span>
<span class="c"># </span>
<span class="c"># User execution confirmation (location varies)</span>
<span class="c"># </span>
<span class="c"># Declare repeated code functions</span>
<span class="c"># </span>
<span class="c"># !! MAIN SECTION !!</span>
<span class="c"># </span>
<span class="c"># Validity tests (setting exit status)</span>
<span class="c"># </span>
<span class="c"># </span>
<span class="c"># Main code, if Valid</span>
<span class="c"># </span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s2">&quot;iterative for loop&quot;</span>
<span class="c">#</span>
<span class="nb">echo</span> -e -n <span class="s1">&#39;\e[32m&#39;</span>
<span class="k">for </span>NAME in <span class="s1">&#39;in&#39;</span> <span class="s1">&#39;inn&#39;</span> <span class="s1">&#39;ian&#39;</span> <span class="s1">&#39;eoin&#39;</span>
<span class="k">do</span>
<span class="k">  </span><span class="nb">echo</span> <span class="s2">&quot;$NAME&quot;</span>
<span class="k">done</span>
<span class="nb">echo</span> -e <span class="s1">&#39;\e[0m&#39;</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s2">&quot;integer for loop&quot;</span>
<span class="c">#</span>
<span class="c"># for (( K=4; $K -ge 0; $K-- ))</span>
<span class="c"># do</span>
<span class="c">#   echo &quot;The negative of $K squared is: $(( K * -K ))&quot;</span>
<span class="c"># done</span>
<span class="c"># </span>
<span class="k">for</span> <span class="o">((</span> <span class="nv">K</span><span class="o">=</span>4; <span class="nv">$K</span>&gt;<span class="o">=</span>0; K-- <span class="o">))</span>
<span class="k">do</span>
<span class="k">  </span><span class="nb">echo</span> -e <span class="s2">&quot;\e[32m The negative of $K squared is: $(( K * -K )) \e[0m&quot;</span>
<span class="k">done</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s2">&quot;case branching test&quot;</span>
<span class="c">#</span>
<span class="nv">OPT</span><span class="o">=</span><span class="s1">&#39;YNmaybe&#39;</span>
<span class="c"># OPT=&#39;dontknow&#39;</span>
<span class="c"># OPT=&#39;whatever&#39;</span>
<span class="nv">ANS</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="k">case</span> <span class="nv">$OPT</span> in 
  Y*|y*<span class="o">)</span>
    ANS+<span class="o">=</span><span class="s2">&quot;positive answer\n&quot;</span> ;;
  *N*|*n*<span class="o">)</span>
    ANS+<span class="o">=</span><span class="s2">&quot;negative answer\n&quot;</span> ;;&amp;
  *<span class="o">)</span>
    ANS+<span class="o">=</span><span class="s2">&quot;ambiguous answer\n&quot;</span> ;;
<span class="k">esac</span>
<span class="nb">echo</span> -e -n <span class="s2">&quot;\e[32m$ANS\e[0m&quot;</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s2">&quot;if branching test&quot;</span>
<span class="c">#</span>
<span class="nv">CHROMEVER</span><span class="o">=</span><span class="s1">&#39;google-chrome-stable_current_&#39;</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$EUID</span> -eq 0 <span class="o">]]</span> 
<span class="k">then </span>
<span class="k">  </span><span class="nv">PTN</span><span class="o">=</span><span class="s1">&#39;i*86&#39;</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="sb">`</span>uname -i<span class="sb">`</span> <span class="o">=</span>~ <span class="nv">$PTN</span> <span class="o">]]</span>
  <span class="k">then</span>
<span class="k">    </span>CHROMEVER+<span class="o">=</span><span class="s1">&#39;i386.deb&#39;</span>
  <span class="k">else</span>
<span class="k">    </span>CHROMEVER+<span class="o">=</span><span class="s1">&#39;amd64.deb&#39;</span>
  <span class="k">fi</span>
<span class="k">  </span><span class="nb">echo</span> -e <span class="s2">&quot;\e[32m $CHROMEVER \e[0m&quot;</span>
<span class="k">else</span>
<span class="k">  </span><span class="nb">echo</span> -e <span class="s1">&#39;\e[5;31m try again using sudo \e[0m&#39;</span>
<span class="k">fi</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s2">&quot;While / Until looping tests&quot;</span>
<span class="c">#</span>
<span class="nv">K</span><span class="o">=</span>5
<span class="k">while</span> <span class="o">[</span> <span class="nv">$K</span> -gt 0 <span class="o">]</span>
<span class="c"># until [[ $K -le 0 ]]</span>
<span class="k">do</span>
  <span class="o">((</span> K-- <span class="o">))</span>
  <span class="nb">echo</span> -e <span class="s2">&quot;\e[32m $K squared is: $(( K ** 2 )) \e[0m&quot;</span>
<span class="k">done</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s2">&quot;select loop&quot;</span>
<span class="c">#</span>
<span class="k">select </span>NAME in <span class="s1">&#39;in&#39;</span> <span class="s1">&#39;inn&#39;</span> <span class="s1">&#39;ian&#39;</span> <span class="s1">&#39;eoin&#39;</span>
<span class="k">do</span>
<span class="k">  </span><span class="nb">echo</span> -e <span class="s2">&quot;\e[32m $NAME \e[0m&quot;</span>
<span class="k">done</span>
<span class="c">#</span>
<span class="c"># </span>
<span class="c"># Exit section: echo results, log errors</span>
<span class="c"># </span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="sample-installer-script">
<span id="installer-answers"></span><h2>Sample Installer Script<a class="headerlink" href="#sample-installer-script" title="Permalink to this headline">¶</a></h2>
<p>Download a sample script answering the Lesson 3 installer code challenge
<a class="reference download internal" href="_downloads/installer.sh"><tt class="xref download docutils literal"><span class="pre">here</span></tt></a>, or just view the code below.</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#! /bin/sh</span>
<span class="c"># --- Program Principal Objective ---</span>
<span class="c"># For Ubuntu up to 14.04 or other Ubuntu-based desktop systems: </span>
<span class="c"># This script installs core utilities and general productivity apps.</span>
<span class="c"># </span>
<span class="c"># ##### VARIABLE DECLARATIONS</span>
<span class="c"># </span>
<span class="nv">PROMPT</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="nv">EXIT</span><span class="o">=</span>0
<span class="nv">OS</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="nv">VERSION</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="nv">APTMGR</span><span class="o">=</span><span class="s1">&#39;apt-get&#39;</span>
<span class="nv">REPOS</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="nv">APT</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="nv">PKGS</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="c"># default values before configuration</span>
<span class="nv">MIRRORS</span><span class="o">=</span><span class="s1">&#39;MIRRORS=(&quot;http://us.archive.ubuntu.com/ubuntu&#39;</span>
MIRRORS+<span class="o">=</span><span class="s1">&#39;,http://mirror.pnl.gov/ubuntu/&#39;</span>
MIRRORS+<span class="o">=</span><span class="s1">&#39;,http://mirrors.centarra.com/ubuntu/&#39;</span>
MIRRORS+<span class="o">=</span><span class="s1">&#39;,http://mirror.tocici.com/ubuntu/&#39;</span>
MIRRORS+<span class="o">=</span><span class="s1">&#39;,http://mirrors.us.kernel.org/ubuntu/&quot;)&#39;</span>
<span class="c"># </span>
<span class="c"># CONFIGURATION VALUES FROM FILE</span>
<span class="c"># </span>
<span class="c"># (none used)</span>
<span class="c">#.</span>
<span class="c"># ##### PARAMETER ASSIGNMENTS</span>
<span class="c"># </span>
<span class="c"># (none used)</span>
<span class="c"># </span>
<span class="c"># ##### FUNCTION DECLARATIONS</span>
<span class="c"># </span>
confirm<span class="o">()</span> <span class="o">{</span>
  <span class="c"># uses $PROMPT, returns $EXIT</span>
  <span class="c">#</span>
  tput rev
  <span class="nb">echo</span> -n <span class="nv">$PROMPT</span>
  <span class="nb">read</span> -n 1 -p <span class="s2">&quot;? [Y/n]&quot;</span> RESPONSE
  tput sgr0
  <span class="nb">echo</span>
<span class="nb">  </span><span class="k">case</span> <span class="nv">$RESPONSE</span> in
    Y|y<span class="o">)</span>
      <span class="nv">EXIT</span><span class="o">=</span>0 ;;
    N|n<span class="o">)</span>
      <span class="nv">EXIT</span><span class="o">=</span>1 ;;
    *<span class="o">)</span>
      <span class="nv">EXIT</span><span class="o">=</span>2 ;;
  <span class="k">esac</span>
<span class="o">}</span>
<span class="c"># </span>
apt-manager<span class="o">()</span> <span class="o">{</span>
  <span class="c"># returns APTMGR</span>
  <span class="c">#</span>
  dpkg -s <span class="s1">&#39;apt-fast&#39;</span> &gt; /dev/null 2&gt;&amp;1
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -ne 0 <span class="o">]</span>
  <span class="k">then</span>
<span class="k">    </span><span class="nv">APTMGR</span><span class="o">=</span><span class="s1">&#39;apt-get&#39;</span>
  <span class="k">else</span>
<span class="k">    </span><span class="nv">APTMGR</span><span class="o">=</span><span class="s1">&#39;apt-fast&#39;</span>
  <span class="k">fi</span>
<span class="o">}</span>
<span class="c"># </span>
apt-repos<span class="o">()</span> <span class="o">{</span>
  <span class="c"># uses REPOS, APTMGR, returns APT</span>
  <span class="c"># calls apt-manager</span>
  <span class="c">#</span>
  apt-manager
  <span class="c"># Install repositories listed in variable REPOS</span>
  <span class="nv">APT</span><span class="o">=</span>0
  <span class="k">for </span>NAME in <span class="nv">$REPOS</span>
  <span class="k">do</span>
<span class="k">    </span>APT+<span class="o">=</span>1
    apt-add-repository <span class="nv">$NAME</span>
  <span class="k">done</span>
  <span class="c"># verify installation and update packages indexes</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$APT</span> -ne 0 <span class="o">]</span> 
  <span class="k">then</span>
<span class="k">    </span><span class="nb">echo</span> -e <span class="s2">&quot;\e[1;32m Updating repository indexes \e[0m&quot;</span>
    <span class="nv">$APTMGR</span> -y -f install <span class="o">&amp;&amp;</span> apt-get -y update 
  <span class="k">fi</span>
<span class="o">}</span>
<span class="c">#</span>
apt-pkgs<span class="o">()</span> <span class="o">{</span>
  <span class="c"># uses PKGS, APTMGR; returns APT</span>
  <span class="c"># calls apt-manager</span>
  <span class="c">#</span>
  apt-manager
  <span class="c"># Install packages listed in variable PKGS</span>
  <span class="nv">APT</span><span class="o">=</span>0
  <span class="k">for </span>NAME in <span class="nv">$PKGS</span>
  <span class="k">do</span>
<span class="k">    </span>dpkg -s <span class="nv">$NAME</span> &gt; /dev/null 2&gt;&amp;1
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -ne 0 <span class="o">]</span>
    <span class="k">then</span>
<span class="k">      </span>APT+<span class="o">=</span>1
      <span class="nb">echo</span> -e <span class="s2">&quot;\e[1;32m Missing $NAME will be installed \e[0m&quot;</span>
      <span class="nv">$APTMGR</span> -y install <span class="nv">$NAME</span>
    <span class="k">fi</span>
<span class="k">  done</span>
  <span class="c"># verify installation and update packages indexes</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$APT</span> -ne 0 <span class="o">]</span>
  <span class="k">then</span>
<span class="k">    </span><span class="nb">echo</span> -e <span class="s1">&#39;\e[1;32m Wait as system packages are updated \e[0m&#39;</span>
    <span class="nv">$APTMGR</span> -y -f install <span class="o">&amp;&amp;</span> apt-get -y update 
  <span class="k">fi</span>
<span class="o">}</span>
<span class="c"># </span>
apt-fast-config<span class="o">()</span> <span class="o">{</span>
  <span class="c"># updates configuration file /etc/apt-fast.conf </span>
  <span class="c"># uses MIRRORS, sets /etc/apt-fast.conf</span>
  <span class="c">#</span>
  touch /etc/apt-fast.conf
  sed -r <span class="s2">&quot;/MIRRORS=.*$/d&quot;</span> -i /etc/apt-fast.conf
  sed -r <span class="s2">&quot;$ a\$MIRRORS&quot;</span> -i /etc/apt-fast.conf
<span class="o">}</span>
<span class="c"># </span>
apt-fast-install<span class="o">()</span> <span class="o">{</span>
  <span class="c"># uses VERSION, EXIT, PROMPT</span>
  <span class="c"># returns PKGS</span>
  <span class="c"># calls apt-repos, apt-pkgs, confirm</span>
  <span class="c">#</span>
  <span class="c"># check if apt-fast is installed</span>
  dpkg -s <span class="s1">&#39;apt-fast&#39;</span> &gt; /dev/null 2&gt;&amp;1
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -eq 0 <span class="o">]</span> 
  <span class="k">then</span>
<span class="k">    </span><span class="nv">PROMPT</span><span class="o">=</span><span class="s1">&#39;Skip apt-fast mirror configuration&#39;</span>
    confirm
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$EXIT</span> -ne 0 <span class="o">]</span> 
    <span class="k">then </span>
<span class="k">      </span>apt-fast-config
      <span class="nv">EXIT</span><span class="o">=</span>0
    <span class="k">fi</span>
<span class="k">  else</span>
    <span class="c"># determine REPOS for apt-fast</span>
    <span class="k">case</span> <span class="nv">$VERSION</span> in
      10*|11*|12*|13*|14.04*<span class="o">)</span>
        <span class="nv">REPOS</span><span class="o">=</span><span class="s1">&#39;ppa:apt-fast/stable&#39;</span> ;;
      *<span class="o">)</span> 
        <span class="nb">echo</span> -e <span class="s2">&quot;\e[1;31m apt-fast is not released for $VERSION \e[0m&quot;</span> ;;
    <span class="k">esac</span>
    <span class="c">#</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$REPOS</span> !<span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="o">]</span>
    <span class="k">then</span>
<span class="k">      </span><span class="nv">PROMPT</span><span class="o">=</span><span class="s1">&#39;Install program apt-fast&#39;</span>
      confirm
      <span class="k">if</span> <span class="o">[</span> <span class="nv">$EXIT</span> -gt 0 <span class="o">]</span> 
      <span class="k">then </span><span class="nv">EXIT</span><span class="o">=</span>0 ;        <span class="c"># not confirmed, reset EXIT</span>
      <span class="k">else</span>
        <span class="c"># install apt-fast</span>
        <span class="nv">PKGS</span><span class="o">=</span><span class="s1">&#39;apt-fast&#39;</span>
        apt-repos
        apt-pkgs
        apt-fast-config
      <span class="k">fi</span>
<span class="k">    fi</span>
<span class="k">  fi</span>
<span class="o">}</span>
<span class="c">#</span>
<span class="c"># ##### CONFIRM EXECUTION</span>
<span class="c"># </span>
<span class="c"># check OS type </span>
<span class="c"># Uses PROMPT, returns OS, VERSION, EXIT</span>
<span class="nb">read </span>OS &lt; /etc/issue
<span class="k">case</span> <span class="nv">$OS</span> in
  Ubuntu*<span class="o">)</span>
    <span class="nv">ARRAY</span><span class="o">=(</span><span class="nv">$OS</span><span class="o">)</span>
    <span class="nv">VERSION</span><span class="o">=</span><span class="k">${</span><span class="nv">ARRAY</span><span class="p">[1]</span><span class="k">}</span> ;;
  Debian*<span class="o">)</span> ;;
  *<span class="o">)</span>
    <span class="nb">echo</span> <span class="s2">&quot;Not Debian or Ubuntu, exiting ...&quot;</span>
    <span class="nv">EXIT</span><span class="o">=</span>1 ;;
<span class="k">esac</span>
<span class="c"># </span>
<span class="c"># Check privileges</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$EUID</span> -ne 0 <span class="o">]</span>
<span class="k">then</span>
<span class="k">  </span><span class="nb">echo</span> -e <span class="s2">&quot;\e[1;31m try again using sudo \e[0m&quot;</span>
  <span class="nv">EXIT</span><span class="o">=</span>1
<span class="k">else</span>
  <span class="c"># test user confirmation</span>
  <span class="nv">PROMPT</span><span class="o">=</span><span class="s1">&#39;Install packages for Kubuntu&#39;</span>
  confirm
<span class="k">fi</span>
<span class="c"># </span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$EXIT</span> -gt 0 <span class="o">]</span>
<span class="k">then </span>
<span class="k">  </span><span class="nb">echo</span> -e <span class="s2">&quot;\e[1;31m Package installation was canceled. \e[0m&quot;</span>
  <span class="nb">exit</span> <span class="nv">$EXIT</span>
<span class="k">fi</span>
<span class="c"># </span>
<span class="c"># ##### MAIN VALIDITY TESTS</span>
<span class="c">#</span>
apt-fast-install
<span class="c"># </span>
<span class="c"># ##### MAIN CODE</span>
<span class="c"># </span>

<span class="c"># universe/multiverse repositories</span>
apt-add-repository <span class="s2">&quot;deb http://archive.ubuntu.com/ubuntu $(lsb_release -sc) main universe restricted multiverse&quot;</span>

<span class="c"># add repositories for: Cinelerra, Ubuntu tweaks, Rails</span>
<span class="c"># REPOS=&#39;ppa:cinelerra-ppa/ppa ppa:tualatrix/ppa ppa:ubuntu-on-rails/ppa&#39;</span>
<span class="c"># apt-repos</span>

<span class="c"># upgrade curl, firefox, ttf-lyx, ubufox</span>
<span class="nv">PKGS</span><span class="o">=</span><span class="s1">&#39;curl firefox ttf-lyx ubufox&#39;</span>
apt-pkgs

<span class="c"># install Google Chrome stable</span>
<span class="nv">CHROMEVER</span><span class="o">=</span><span class="s1">&#39;google-chrome-stable_current_&#39;</span>
<span class="k">if</span> <span class="o">[[</span> <span class="sb">`</span>uname -i<span class="sb">`</span> <span class="o">=</span>~ i*86 <span class="o">]]</span> 
<span class="k">then </span>CHROMEVER+<span class="o">=</span><span class="s1">&#39;i386.deb&#39;</span>
<span class="k">else </span>CHROMEVER+<span class="o">=</span><span class="s1">&#39;amd64.deb&#39;</span>
<span class="k">fi </span>
wget -O /tmp/chrome.deb https://dl-ssl.google.com/linux/direct/<span class="nv">$CHROMEVER</span>
dpkg -i /tmp/chrome.deb
rm /tmp/chrome.deb

<span class="c"># install desktop productivity apps</span>
<span class="nv">PKGS</span><span class="o">=</span><span class="s1">&#39;blender dia filezilla freemind gimp gnucash inkscape mypaint&#39;</span>
PKGS+<span class="o">=</span><span class="s1">&#39; openshot scribus shotwell xaralx xsane&#39;</span>
<span class="c"># PKGS+=&#39; cinelerra&#39;</span>
apt-pkgs

<span class="c"># install desktop utility apps</span>
<span class="nv">PKGS</span><span class="o">=</span><span class="s1">&#39;aptitude byobu cifs-utils diffuse dosbox dosemu&#39;</span>
PKGS+<span class="o">=</span><span class="s1">&#39; hplip-gui keepassx krdc kubuntu-restricted-extras lftp mc&#39;</span>
PKGS+<span class="o">=</span><span class="s1">&#39; nfs-common openvpn plasma-widget-lancelot putty recordmydesktop&#39;</span> 
PKGS+<span class="o">=</span><span class="s1">&#39; screen shutter unison vlc whois wine wireshark xclip&#39;</span>
<span class="c"># PKGS+=&#39; playonlinux ubuntu-tweak&#39;</span>
apt-pkgs

<span class="c"># install Sun (Oracle) java</span>
<span class="nv">PKGS</span><span class="o">=</span><span class="s1">&#39;sun-java6-bin sun-java6-fonts sun-java6-javadb sun-java6-jdk&#39;</span>
PKGS+<span class="o">=</span><span class="s1">&#39; sun-java6-jre sun-java6-plugin&#39;</span>
apt-pkgs

<span class="c"># install playonlinux windows game console</span>
<span class="c"># wget -q &quot;http://deb.playonlinux.com/public.gpg&quot; -O- | apt-key add -</span>
<span class="c"># wget http://deb.playonlinux.com/playonlinux_trusty.list -O /etc/apt/sources.list.d/playonlinux.list</span>
<span class="c"># $APTMGR update</span>
<span class="c"># $APTMGR install playonlinux</span>
<span class="c"># </span>
<span class="c"># ##### EXIT CODE</span>
<span class="c"># </span>
apt-get clean <span class="o">&amp;&amp;</span> apt-get update <span class="o">&amp;&amp;</span> apt-get upgrade

<span class="k">if</span> <span class="o">[</span> <span class="nv">$EXIT</span> -eq 0 <span class="o">]</span> 
<span class="k">then</span>
<span class="k">  </span><span class="nv">PROMPT</span><span class="o">=</span><span class="s1">&#39;Installation successful. Reboot now&#39;</span>
  <span class="k">if</span> <span class="o">[</span><span class="nv">$EXIT</span> -gt 0 <span class="o">]</span> 
  <span class="k">then </span>reboot &amp;
  <span class="k">fi</span>
<span class="k">else </span><span class="nb">echo</span> <span class="s2">&quot;EXIT value is $EXIT&quot;</span>
<span class="k">fi</span>

<span class="nb">exit</span> <span class="nv">$EXIT</span>

<span class="c">################################################################################</span>

<span class="c"># 10/12/14 GARL -- Added apt-fast installation to speed routine</span>
<span class="c"># 10/29/14 GARL -- Rewritten for TechCamp 2014 workshop</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="07_lesson3.html" title="Exercise 3: Automation Script"
             >previous</a></li>
        <li><a href="index.html">Linux Shell Script Programming 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Gerald Lovel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>