<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Lesson Sample Scripts &mdash; Linux Shell Script Programming 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/aaltsys.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Linux Shell Script Programming 1.0 documentation" href="index.html" />
    <link rel="prev" title="Exercise 3: Automation Script" href="07_lesson3.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="07_lesson3.html" title="Exercise 3: Automation Script"
             accesskey="P">previous</a></li>
        <li><a href="index.html">Linux Shell Script Programming 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Lesson Sample Scripts</a><ul>
<li><a class="reference internal" href="#example-program-outline">Example Program Outline</a></li>
<li><a class="reference internal" href="#sample-hello-world-script">Sample Hello World! Script</a></li>
<li><a class="reference internal" href="#sample-expressions-script">Sample Expressions Script</a></li>
<li><a class="reference internal" href="#sample-logic-control-script">Sample Logic Control Script</a></li>
<li><a class="reference internal" href="#sample-installer-script">Sample Installer Script</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="07_lesson3.html"
                        title="previous chapter">Exercise 3: Automation Script</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/10_answers.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="lesson-sample-scripts">
<span id="answers"></span><h1>Lesson Sample Scripts<a class="headerlink" href="#lesson-sample-scripts" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Commands which produced wrong output on the target Ubuntu system have been
commented out, but are left in place for instruction and reference.</p>
</div>
<div class="section" id="example-program-outline">
<span id="hello-answers"></span><h2>Example Program Outline<a class="headerlink" href="#example-program-outline" title="Permalink to this headline">¶</a></h2>
<p>Download an example script outline <a class="reference download internal" href="_downloads/example.sh"><tt class="xref download docutils literal"><span class="pre">here</span></tt></a>,
as organized in this guide, or just view the code below.</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#! /bin/sh</span>
<span class="c"># Describe program&#39;s principal objective</span>
<span class="c"># </span>
<span class="c"># Initialize variables</span>
<span class="c"># </span>
<span class="c"># Assign parameters ($n) to named variables</span>
<span class="c"># </span>
<span class="c"># User execution confirmation (location varies)</span>
<span class="c"># </span>
<span class="c"># Declare repeated code functions</span>
<span class="c"># </span>
<span class="c"># !! MAIN SECTION !!</span>
<span class="c"># </span>
<span class="c"># Validity tests (setting exit status)</span>
<span class="c"># </span>
<span class="c"># Main code, if Valid</span>
<span class="c"># </span>
<span class="c"># Exit section: echo results, log errors</span>
<span class="c"># </span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="sample-hello-world-script">
<h2>Sample Hello World! Script<a class="headerlink" href="#sample-hello-world-script" title="Permalink to this headline">¶</a></h2>
<p>Download a sample script answering the Hello World challenge of Lesson 1
<a class="reference download internal" href="_downloads/hello-world.sh"><tt class="xref download docutils literal"><span class="pre">here</span></tt></a>, or just view the code below.</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#! /bin/bash</span>
<span class="c"># My first script, presenting programming to the world</span>
<span class="c"># </span>
<span class="c"># Initialize variables</span>
<span class="nv">DISPLAY</span><span class="o">=</span><span class="s1">&#39;World&#39;</span>
<span class="nv">EXIT</span><span class="o">=</span><span class="s1">&#39;0&#39;</span>
<span class="nv">RESP</span><span class="o">=</span><span class="s1">&#39;n&#39;</span>
<span class="c"># </span>
<span class="c"># Assign parameters ($n) to named variables</span>
<span class="c"># if [$1 != &#39;&#39;]      ; # fails without spaces around [ ]</span>
<span class="c"># if [ $1 != &#39;&#39; ]    ; # works with !# and single [ ]</span>
<span class="c"># if [ ! $1 == &#39;&#39; ]  ; # works to (!) negate the expression</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$1</span> !<span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="o">]]</span>    ; <span class="c"># works w/ single [ and double [[ </span>
<span class="k">then </span><span class="nv">DISPLAY</span><span class="o">=</span><span class="nv">$1</span>
<span class="k">fi</span>
<span class="c"># </span>
<span class="c"># User execution confirmation (location varies)</span>
<span class="c"># echo &quot;Say Hello?&quot; </span>
<span class="c"># echo &quot;\n\e[1;31m Say Hello?&quot;</span>
<span class="nb">echo</span> -e -n <span class="s1">&#39;\n\e[1;31m Say Hello&#39;</span>
<span class="nb">read</span> -n 1 -p <span class="s1">&#39; (y/n)?&#39;</span> RESP 
<span class="nb">echo</span> -e <span class="s1">&#39;\e[0m&#39;</span>
<span class="k">case</span> <span class="nv">$RESP</span> in
  y|Y<span class="o">)</span>
    <span class="nv">EXIT</span><span class="o">=</span><span class="s1">&#39;0&#39;</span> ;;
  n|N<span class="o">)</span>
    <span class="nv">EXIT</span><span class="o">=</span><span class="s1">&#39;1&#39;</span> ;;
  *<span class="o">)</span>
    <span class="nv">EXIT</span><span class="o">=</span><span class="s1">&#39;2&#39;</span> ;;
<span class="k">esac</span>
<span class="c"># </span>
<span class="c"># Declare repeated code functions (none declared)</span>
<span class="c"># </span>
<span class="c"># !! MAIN SECTION !!</span>
<span class="c"># </span>
<span class="c"># Validity tests (setting exit status)</span>
<span class="c"># </span>
<span class="c"># Main code, if Valid</span>
<span class="c"># </span>
<span class="c"># Exit section: echo results, log errors</span>
<span class="c"># echo &#39;Hello World&#39;</span>
<span class="c"># echo &#39;Hello DISPLAY&#39;  ; # full quoting</span>
<span class="c"># echo &quot;hello DISPLAY&quot;  ; # partial quoting</span>
<span class="c"># echo &#39;Hello $DISPLAY&#39; ; # $-operator for evaluation</span>
<span class="c"># echo &quot;Hello $DISPLAY&quot; ; # $ evaluation in partial quotes</span>

<span class="c"># exit statements with user message display</span>
<span class="k">case</span> <span class="nv">$EXIT</span> in
  <span class="s1">&#39;0&#39;</span> <span class="o">)</span>
    <span class="c"># echo -e &quot;\nHello $DISPLAY&quot; ;;</span>
    <span class="nb">echo</span> -e <span class="s2">&quot;\n\e[1;32m Hello $DISPLAY \e[0m\n&quot;</span> ;;
  * <span class="o">)</span>
    <span class="c"># echo -e &quot;\nCanceled&quot; ;;</span>
    <span class="nb">echo</span> -e <span class="s2">&quot;\n\e[1;31m Canceled \e[0m\n&quot;</span> ;;
<span class="k">esac</span>

<span class="nb">exit</span> <span class="nv">$EXIT</span>
<span class="c"># </span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="sample-expressions-script">
<span id="expressions-answers"></span><h2>Sample Expressions Script<a class="headerlink" href="#sample-expressions-script" title="Permalink to this headline">¶</a></h2>
<p>Download a sample script answering the expressions topics from Lesson 2
<a class="reference download internal" href="_downloads/expressions.sh"><tt class="xref download docutils literal"><span class="pre">here</span></tt></a>, or just view the code below.</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="c"># Describe program&#39;s principal objective</span>
<span class="c"># </span>
<span class="c"># Initialize variables</span>
<span class="c"># </span>
<span class="c">#</span>
<span class="c"># Assign parameters ($n) to named variables</span>
<span class="c"># </span>
<span class="c"># User execution confirmation (location varies)</span>
<span class="c"># </span>
<span class="c"># Declare repeated code functions</span>
<span class="c"># </span>
<span class="c"># !! MAIN SECTION !!</span>
<span class="c"># </span>
<span class="c"># Validity tests (setting exit status)</span>
<span class="c"># </span>
<span class="nb">echo</span>
<span class="nb">echo test </span>variable expansion in quotes
<span class="c">#</span>
<span class="nv">COMMAND</span><span class="o">=</span><span class="s1">&#39;git branch -a&#39;</span>
<span class="nb">echo</span> <span class="nv">$COMMAND</span>
<span class="c"># echo &#39;$COMMAND&#39;</span>
<span class="nb">echo</span> <span class="s2">&quot;$COMMAND&quot;</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo test command </span>execution in parentheses
<span class="c">#</span>
<span class="nv">COMMAND</span><span class="o">=</span><span class="s1">&#39;git branch -a&#39;</span>
<span class="c"># echo $( &quot;$COMMAND&quot; )</span>
<span class="k">$(</span> <span class="nb">echo</span> <span class="nv">$COMMAND</span> <span class="k">)</span>
<span class="c"># $( echo &#39;$COMMAND&#39; )</span>
<span class="k">$(</span> <span class="nb">echo</span> <span class="s2">&quot;$COMMAND&quot;</span> <span class="k">)</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo test command </span>list in parentheses
<span class="c">#</span>
<span class="nv">TEXT</span><span class="o">=</span><span class="s1">&#39;embedded grouped commands&#39;</span>
<span class="c"># echo -e $(</span>
<span class="c">#   &#39;\e[32m These statements test&#39;</span>
<span class="c">#   &quot; $TEXT. \e[0m&quot;</span>
<span class="c"># )</span>
<span class="c">#</span>
<span class="c"># $(</span>
<span class="c">#   echo -e &quot;\e[31m These statements test&quot;</span>
<span class="c">#   echo -e &quot; $TEXT. \e[0m&quot;</span>
<span class="c"># )</span>
<span class="c">#</span>
<span class="nb">echo</span> -e <span class="k">$(</span>
  <span class="nb">echo</span> <span class="s1">&#39;\e[32m These statements test&#39;</span>
  <span class="nb">echo</span> <span class="s2">&quot; $TEXT. \e[0m&quot;</span>
<span class="k">)</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo test command </span>group anonymous <span class="k">function</span>
<span class="c">#</span>
<span class="nv">TEXT</span><span class="o">=</span><span class="s1">&#39;an embedded anonymous function&#39;</span>
<span class="c"># echo -e ${ </span>
<span class="c">#   echo &#39;\e[32m These statements test&#39;</span>
<span class="c">#   echo &quot; $TEXT. \e[0m&quot; </span>
<span class="c"># }</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s1">&#39;test an integer calculation&#39;</span>
<span class="c">#</span>
<span class="nv">SEVEN</span><span class="o">=</span>7
<span class="nv">FIVE</span><span class="o">=</span>5
<span class="c"># echo -e &#39;\e[32m $FIVE times $SEVEN is $(( FIVE * SEVEN )) \e[0m&#39;</span>
<span class="nb">echo</span> -e <span class="s2">&quot;\e[32m $FIVE times $SEVEN is $(( FIVE * SEVEN )) \e[0m&quot;</span>
<span class="c"># </span>
<span class="c"># Main code, if Valid</span>
<span class="c"># </span>
<span class="c"># </span>
<span class="c"># Exit section: echo results, log errors</span>
<span class="c"># </span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="sample-logic-control-script">
<span id="logic-answers"></span><h2>Sample Logic Control Script<a class="headerlink" href="#sample-logic-control-script" title="Permalink to this headline">¶</a></h2>
<p>Download a sample script answering the Lesson 2 logic control topics
<a class="reference download internal" href="_downloads/logic-control.sh"><tt class="xref download docutils literal"><span class="pre">here</span></tt></a>, or just view the code below.</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="c"># Describe program&#39;s principal objective</span>
<span class="c"># </span>
<span class="c"># Initialize variables</span>
<span class="c"># </span>
<span class="c">#</span>
<span class="c"># Assign parameters ($n) to named variables</span>
<span class="c"># </span>
<span class="c"># User execution confirmation (location varies)</span>
<span class="c"># </span>
<span class="c"># Declare repeated code functions</span>
<span class="c"># </span>
<span class="c"># !! MAIN SECTION !!</span>
<span class="c"># </span>
<span class="c"># Validity tests (setting exit status)</span>
<span class="c"># </span>
<span class="c"># </span>
<span class="c"># Main code, if Valid</span>
<span class="c"># </span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s2">&quot;iterative for loop&quot;</span>
<span class="c">#</span>
<span class="nb">echo</span> -e -n <span class="s1">&#39;\e[32m&#39;</span>
<span class="k">for </span>NAME in <span class="s1">&#39;in&#39;</span> <span class="s1">&#39;inn&#39;</span> <span class="s1">&#39;ian&#39;</span> <span class="s1">&#39;eoin&#39;</span>
<span class="k">do</span>
<span class="k">  </span><span class="nb">echo</span> <span class="s2">&quot;$NAME&quot;</span>
<span class="k">done</span>
<span class="nb">echo</span> -e <span class="s1">&#39;\e[0m&#39;</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s2">&quot;integer for loop&quot;</span>
<span class="c">#</span>
<span class="c"># for (( K=4; $K -ge 0; $K-- ))</span>
<span class="c"># do</span>
<span class="c">#   echo &quot;The negative of $K squared is: $(( K * -K ))&quot;</span>
<span class="c"># done</span>
<span class="c"># </span>
<span class="k">for</span> <span class="o">((</span> <span class="nv">K</span><span class="o">=</span>4; <span class="nv">$K</span>&gt;<span class="o">=</span>0; K-- <span class="o">))</span>
<span class="k">do</span>
<span class="k">  </span><span class="nb">echo</span> -e <span class="s2">&quot;\e[32m The negative of $K squared is: $(( K * -K )) \e[0m&quot;</span>
<span class="k">done</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s2">&quot;case branching test&quot;</span>
<span class="c">#</span>
<span class="nv">OPT</span><span class="o">=</span><span class="s1">&#39;YNmaybe&#39;</span>
<span class="c"># OPT=&#39;dontknow&#39;</span>
<span class="c"># OPT=&#39;whatever&#39;</span>
<span class="nv">ANS</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="k">case</span> <span class="nv">$OPT</span> in 
  Y*|y*<span class="o">)</span>
    ANS+<span class="o">=</span><span class="s2">&quot;positive answer\n&quot;</span> ;;
  *N*|*n*<span class="o">)</span>
    ANS+<span class="o">=</span><span class="s2">&quot;negative answer\n&quot;</span> ;;&amp;
  *<span class="o">)</span>
    ANS+<span class="o">=</span><span class="s2">&quot;ambiguous answer\n&quot;</span> ;;
<span class="k">esac</span>
<span class="nb">echo</span> -e -n <span class="s2">&quot;\e[32m$ANS\e[0m&quot;</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s2">&quot;if branching test&quot;</span>
<span class="c">#</span>
<span class="nv">CHROMEVER</span><span class="o">=</span><span class="s1">&#39;google-chrome-stable_current_&#39;</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$EUID</span> -eq 0 <span class="o">]]</span> 
<span class="k">then </span>
<span class="k">  </span><span class="nv">PTN</span><span class="o">=</span><span class="s1">&#39;i*86&#39;</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="sb">`</span>uname -i<span class="sb">`</span> <span class="o">=</span>~ <span class="nv">$PTN</span> <span class="o">]]</span>
  <span class="k">then</span>
<span class="k">    </span>CHROMEVER+<span class="o">=</span><span class="s1">&#39;i386.deb&#39;</span>
  <span class="k">else</span>
<span class="k">    </span>CHROMEVER+<span class="o">=</span><span class="s1">&#39;amd64.deb&#39;</span>
  <span class="k">fi</span>
<span class="k">  </span><span class="nb">echo</span> -e <span class="s2">&quot;\e[32m $CHROMEVER \e[0m&quot;</span>
<span class="k">else</span>
<span class="k">  </span><span class="nb">echo</span> -e <span class="s1">&#39;\e[5;31m try again using sudo \e[0m&#39;</span>
<span class="k">fi</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s2">&quot;While / Until looping tests&quot;</span>
<span class="c">#</span>
<span class="nv">K</span><span class="o">=</span>5
<span class="k">while</span> <span class="o">[</span> <span class="nv">$K</span> -gt 0 <span class="o">]</span>
<span class="c"># until [[ $K -le 0 ]]</span>
<span class="k">do</span>
  <span class="o">((</span> K-- <span class="o">))</span>
  <span class="nb">echo</span> -e <span class="s2">&quot;\e[32m $K squared is: $(( K ** 2 )) \e[0m&quot;</span>
<span class="k">done</span>
<span class="c">#</span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s2">&quot;select loop&quot;</span>
<span class="c">#</span>
<span class="k">select </span>NAME in <span class="s1">&#39;in&#39;</span> <span class="s1">&#39;inn&#39;</span> <span class="s1">&#39;ian&#39;</span> <span class="s1">&#39;eoin&#39;</span>
<span class="k">do</span>
<span class="k">  </span><span class="nb">echo</span> -e <span class="s2">&quot;\e[32m $NAME \e[0m&quot;</span>
<span class="k">done</span>
<span class="c">#</span>
<span class="c"># </span>
<span class="c"># Exit section: echo results, log errors</span>
<span class="c"># </span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="sample-installer-script">
<span id="installer-answers"></span><h2>Sample Installer Script<a class="headerlink" href="#sample-installer-script" title="Permalink to this headline">¶</a></h2>
<p>Download a sample script answering the Lesson 3 installer code challenge
<a class="reference download internal" href="_downloads/installer.sh"><tt class="xref download docutils literal"><span class="pre">here</span></tt></a>, or just view the code below.</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#! /bin/sh</span>
<span class="c"># --- Program Principal Objective ---</span>
<span class="c"># For Kubuntu 14.x or other Ubuntu-based KDE desktop systems: </span>
<span class="c"># This script installs core utilities and general productivity apps.</span>
<span class="c"># </span>
<span class="c"># ##### DECLARE VARIABLES</span>
<span class="c"># </span>
<span class="nv">PROMPT</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="nv">EXIT</span><span class="o">=</span>0
<span class="nv">OS</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="nv">VERSION</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="c">#</span>
<span class="c"># ##### ASSIGN PARAMETERS</span>
<span class="c"># </span>
<span class="c"># (none used)</span>
<span class="c"># </span>
<span class="c"># ##### DECLARE FUNCTIONS</span>
<span class="c"># </span>
confirm<span class="o">()</span> <span class="o">{</span>
  <span class="c"># Requires $PROMPT, returns $EXIT</span>
  tput rev
  <span class="nb">echo</span> -n <span class="nv">$PROMPT</span>
  <span class="nb">read</span> -n 1 -p <span class="s2">&quot; (Yes/no)?&quot;</span> RESPONSE
  tput sgr0
  <span class="nb">echo</span>
<span class="nb">  </span><span class="k">case</span> <span class="nv">$RESPONSE</span> in
    Y*|y*<span class="o">)</span>
      <span class="nv">EXIT</span><span class="o">=</span><span class="s1">&#39;0&#39;</span> ;;
    *N*|*n*<span class="o">)</span>
      <span class="nv">EXIT</span><span class="o">=</span><span class="s1">&#39;1&#39;</span> ;;
    *<span class="o">)</span>
      <span class="nv">EXIT</span><span class="o">=</span><span class="s1">&#39;2&#39;</span> ;;
  <span class="k">esac</span>
<span class="o">}</span>
<span class="c"># </span>
apt-manager<span class="o">()</span> <span class="o">{</span>
  <span class="c"># Determine apt package management command --</span>
  dpkg -s <span class="s1">&#39;apt-fast&#39;</span> &gt; null
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -ne 0 <span class="o">]</span> ; <span class="k">then</span>
<span class="k">    </span><span class="nv">APTMGR</span><span class="o">=</span><span class="s1">&#39;apt-get&#39;</span>
  <span class="k">else</span>
<span class="k">    </span><span class="nv">APTMGR</span><span class="o">=</span><span class="s1">&#39;apt-fast&#39;</span>
  <span class="k">fi</span>
<span class="o">}</span>
<span class="c"># </span>
apt-repos<span class="o">()</span> <span class="o">{</span>
  <span class="c"># uses REPOS, APTMGR, returns APT</span>
  <span class="c"># calls apt-manager</span>
  <span class="c">#</span>
  apt-manager
  <span class="c"># Install repositories listed in variable REPOS</span>
  <span class="nv">APT</span><span class="o">=</span>0
  <span class="k">for </span>NAME in <span class="nv">$REPOS</span>
  <span class="k">do</span>
<span class="k">    </span>APT+<span class="o">=</span>1
    apt-add-repository <span class="nv">$NAME</span>
  <span class="k">done</span>
  <span class="c"># verify installation and update packages indexes</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$APT</span> -ne 0 <span class="o">]</span> 
  <span class="k">then</span>
<span class="k">    </span><span class="nb">echo</span> -e  <span class="s2">&quot;\e[1;32m Updating system repository indexes \e[0m&quot;</span>
    <span class="nv">$APTMGR</span> -y -f install <span class="o">&amp;&amp;</span> <span class="nv">$APTMGR</span> -y update 
  <span class="k">fi</span>
<span class="o">}</span>
<span class="c">#</span>
apt-pkgs<span class="o">()</span> <span class="o">{</span>
  <span class="c"># uses PKGS, APTMGR; returns APT</span>
  <span class="c"># calls apt-manager</span>
  <span class="c">#</span>
  apt-manager
  <span class="c"># Install packages listed in variable PKGS</span>
  <span class="nv">APT</span><span class="o">=</span>0
  <span class="k">for </span>NAME in <span class="nv">$PKGS</span>
  <span class="k">do</span>
<span class="k">    </span>dpkg -s <span class="nv">$NAME</span> &gt; null
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -ne 0 <span class="o">]</span> ; <span class="k">then</span>
<span class="k">      </span>APT+<span class="o">=</span>1
      <span class="nb">echo</span> -e <span class="s2">&quot;\e[1;31m $NAME is missing, it will be installed \e[0m&quot;</span>
      <span class="nv">$APTMGR</span> -y install <span class="nv">$NAME</span>
    <span class="k">fi</span>
<span class="k">  done</span>
  <span class="c"># verify installation and update packages indexes</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$APT</span> -ne 0 <span class="o">]</span> ; <span class="k">then</span>
<span class="k">    </span><span class="nb">echo</span> -e <span class="s2">&quot;\e[1;31m Updating system packages, this may take a while \e[0m&quot;</span>
    <span class="nv">$APTMGR</span> -y -f install <span class="o">&amp;&amp;</span> <span class="nv">$APTMGR</span> -y update 
  <span class="k">fi</span>
<span class="o">}</span>
<span class="c"># </span>
apt-fast-install<span class="o">()</span> <span class="o">{</span>
  <span class="c"># uses VERSION, EXIT, PROMPT</span>
  <span class="c"># returns PKGS</span>
  <span class="c"># calls apt-repos, apt-pkgs, confirm</span>
  <span class="c">#</span>
  <span class="c"># check if apt-fast is installed</span>
  <span class="nv">PKGS</span><span class="o">=</span><span class="s1">&#39;apt-fast&#39;</span>
  dpkg -s <span class="nv">$PKGS</span> &gt; null
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -ne 0 <span class="o">]</span> 
  <span class="k">then</span>
    <span class="c"># determine REPOS for apt-fast</span>
    <span class="k">case </span>VERSION in
      11*|12*|13*<span class="o">)</span>
        <span class="nv">REPOS</span><span class="o">=</span><span class="s1">&#39;ppa:apt-fast/stable&#39;</span> ;;
      14*|15*|16*<span class="o">)</span>
        <span class="nv">REPOS</span><span class="o">=</span><span class="s1">&#39;ppa:saiarcot895/myppa&#39;</span> ;;
      *<span class="o">)</span> ;;
    <span class="k">esac</span>
    <span class="c">#</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$REPOS</span> !<span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="o">]</span>
    <span class="k">then</span>
<span class="k">      </span><span class="nv">PROMPT</span><span class="o">=</span><span class="s1">&#39;Install program apt-fast&#39;</span>
      confirm
      <span class="k">if</span> <span class="o">[</span> <span class="nv">$EXIT</span> -gt 0 <span class="o">]</span>
      <span class="k">then</span>
        <span class="c"># not confirmed, reset EXIT</span>
        <span class="nv">EXIT</span><span class="o">=</span><span class="s1">&#39;0&#39;</span>
      <span class="k">else</span>
        <span class="c"># install apt-fast</span>
        <span class="nv">PKGS</span><span class="o">=</span><span class="s1">&#39;apt-fast&#39;</span>
        apt-repos
        apt-pkgs
      <span class="k">fi</span>
<span class="k">    fi</span>
<span class="k">  fi</span>
<span class="o">}</span>
<span class="c">#</span>
<span class="c"># ##### CONFIRM EXECUTION</span>
<span class="c"># </span>
<span class="c"># Check OS type</span>
<span class="nb">read </span>OS &lt; /etc/issue
<span class="k">case</span> <span class="nv">$OS</span> in
  Ubuntu*<span class="o">)</span>
    <span class="nv">ARRAY</span><span class="o">=(</span><span class="nv">$OS</span><span class="o">)</span>
    <span class="nv">VERSION</span><span class="o">=</span><span class="k">${</span><span class="nv">ARRAY</span><span class="p">[1]</span><span class="k">}</span> ;;
  Debian*<span class="o">)</span> ;;
  *<span class="o">)</span>
    <span class="nb">echo</span> <span class="s2">&quot;Not Debian or Ubuntu, exiting ...&quot;</span>
    <span class="nv">EXIT</span><span class="o">=</span><span class="sb">`</span>1<span class="sb">`</span> ;;
<span class="k">esac</span>
<span class="c"># </span>
<span class="c"># Check privileges, user confirmation</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$EUID</span> -ne 0 <span class="o">]]</span>
<span class="k">then</span>
<span class="k">  </span><span class="nb">echo</span> -e <span class="s2">&quot;\e[1;31m try again using sudo \e[0m&quot;</span>
  <span class="nv">EXIT</span><span class="o">=</span><span class="s1">&#39;1&#39;</span>
<span class="k">else</span>
<span class="k">  </span><span class="nv">PROMPT</span><span class="o">=</span><span class="s1">&#39;Install packages for Kubuntu&#39;</span>
  confirm
<span class="k">fi</span>
<span class="c"># </span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$EXIT</span> -gt 0 <span class="o">]]</span>
<span class="k">then </span><span class="nb">exit</span> <span class="nv">$EXIT</span>
<span class="k">fi</span>
<span class="c"># </span>
<span class="c"># !! MAIN SECTION !!</span>
<span class="c"># </span>
<span class="c"># VALIDITY TESTS</span>
<span class="c">#</span>
apt-fast-install
<span class="c"># </span>
<span class="c"># CODE</span>
<span class="c"># </span>
<span class="c"># </span>
<span class="c"># </span>
<span class="c"># Exit section: echo results, log errors</span>
<span class="c"># </span>
<span class="nb">echo</span> <span class="nv">$EXIT</span>
<span class="nb">exit</span> <span class="nv">$EXIT</span>
---

<span class="c">#!/bin/bash</span>
<span class="c"># This script is targeted to KUbuntu 13 KDE or Debian 6 KDE derivatives.</span>
<span class="c"># This desktop script installs general productivity apps.</span>
<span class="c"># The default script interpreter is assumed to be dash/bash.</span>

<span class="c"># Not working lines with this KUbuntu release are marked with !!</span>
<span class="c"># Problem packages are: chrome, cinelerra, adobe-flashplugin, sun-java6</span>

<span class="nb">echo</span> <span class="s2">&quot;Install packages for Kubuntu 14.04 or other Debian 6 KDE&quot;</span>

<span class="k">if</span> <span class="o">[[</span> <span class="nv">$EUID</span> -ne 0 <span class="o">]]</span> ; <span class="k">then </span><span class="nb">echo</span> -e <span class="s2">&quot;\e[1;31m try again using sudo \e[0m&quot;</span> ; <span class="nb">exit </span>1 ; <span class="k">fi</span>

<span class="c"># assumes standard values for whitespace -- safe programming would set this</span>

<span class="nv">APT</span><span class="o">=</span>0
<span class="nv">APTMGR</span><span class="o">=</span><span class="s1">&#39;apt-get&#39;</span>
<span class="nv">PKGS</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="nv">REPOS</span><span class="o">=</span><span class="s1">&#39;&#39;</span>

<span class="c"># !!!!!!!!!!!!!!!!!!!!!!!!!!! apt-manager Routine !!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<span class="c">#===== function to determine apt manager program ==============================</span>

apt-manager<span class="o">()</span> <span class="o">{</span>
  <span class="c"># Determine apt package management command --</span>
  dpkg -s <span class="s1">&#39;apt-fast&#39;</span> &gt; null
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -ne 0 <span class="o">]</span> ; <span class="k">then</span>
<span class="k">    </span><span class="nv">APTMGR</span><span class="o">=</span><span class="s1">&#39;apt-get&#39;</span>
  <span class="k">else</span>
<span class="k">    </span><span class="nv">APTMGR</span><span class="o">=</span><span class="s1">&#39;apt-fast&#39;</span>
  <span class="k">fi</span>
<span class="o">}</span>

<span class="c"># !!!!!!!!!!!!!!!!!!!!!!!!!!! apt-repository Routine !!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<span class="c">#===== function to add a delimited repository list ============================</span>

apt-repos<span class="o">()</span> <span class="o">{</span>

  apt-manager
  <span class="c"># Install repositories listed in variable REPOS</span>
  <span class="nv">APT</span><span class="o">=</span>0
  <span class="k">for </span>i in <span class="nv">$REPOS</span>
  <span class="k">do</span>
<span class="k">    </span><span class="nv">APT</span><span class="o">=</span>1
    apt-add-repository <span class="nv">$i</span>
  <span class="k">done</span>
   
  <span class="c"># verify installation and update packages indexes</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$APT</span> -ne 0 <span class="o">]</span> 
  <span class="k">then</span>
<span class="k">    </span><span class="nb">echo</span> -e  <span class="s2">&quot;\e[1;31m Updating system repository indexes \e[0m&quot;</span>
    <span class="nv">$APTMGR</span> -y -f install <span class="o">&amp;&amp;</span> <span class="nv">$APTMGR</span> -y update 
  <span class="k">fi</span>

<span class="o">}</span>

<span class="c"># !!!!!!!!!!!!!!!!!!!!!!!!!!! apt-install Routine !!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<span class="c">#===== function to install a delimited package list ===========================</span>

apt-pkgs<span class="o">()</span> <span class="o">{</span>

  apt-manager
  <span class="c"># Install packages listed in variable PKGS</span>
  <span class="nv">APT</span><span class="o">=</span>0
  <span class="k">for </span>i in <span class="nv">$PKGS</span>
  <span class="k">do</span>
<span class="k">    </span>dpkg -s <span class="nv">$i</span> &gt; null
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -ne 0 <span class="o">]</span> ; <span class="k">then</span>
<span class="k">      </span><span class="nv">APT</span><span class="o">=</span>1
      <span class="nb">echo</span> <span class="s2">&quot;$i is missing, it will be installed&quot;</span>
      <span class="nv">$APTMGR</span> -y install <span class="nv">$i</span>
    <span class="k">fi</span>
<span class="k">  done</span>

  <span class="c"># verify installation and update packages indexes</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$APT</span> -ne 0 <span class="o">]</span> ; <span class="k">then</span>
<span class="k">    </span><span class="nb">echo</span> -e <span class="s2">&quot;\e[1;31m Updating system packages, this may take a while \e[0m&quot;</span>
    <span class="nv">$APTMGR</span> -y -f install <span class="o">&amp;&amp;</span> <span class="nv">$APTMGR</span> -y update 
  <span class="k">fi</span>

<span class="o">}</span>

<span class="c"># !!!!!!!!!!!!!!!!!!!!!!!!!!! Main Program !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<span class="c">#==============================================================================</span>

<span class="c"># install, configure apt-fast</span>
<span class="c"># ###########################</span>

<span class="nv">REPOS</span><span class="o">=</span><span class="s1">&#39;ppa:saiarcot895/myppa&#39;</span>
apt-repos
<span class="nv">PKGS</span><span class="o">=</span><span class="s1">&#39;apt-fast&#39;</span>
apt-pkgs
<span class="nv">MIRRORS</span><span class="o">=</span><span class="s1">&#39;MIRRORS=(&quot;http://us.archive.ubuntu.com/ubuntu,&#39;</span>
MIRRORS+<span class="o">=</span><span class="s1">&#39;http://mirror.cc.columbia.edu/pub/linux/ubuntu/archive/,&#39;</span>
MIRRORS+<span class="o">=</span><span class="s1">&#39;http://mirror.cc.vt.edu/pub2/ubuntu/,&#39;</span>
MIRRORS+<span class="o">=</span><span class="s1">&#39;http://mirror.umd.edu/ubuntu/,&#39;</span>
MIRRORS+<span class="o">=</span><span class="s1">&#39;http://mirrors.mit.edu/ubuntu/&quot;)&#39;</span>
sed -r <span class="s2">&quot;/MIRRORS=.*$/d&quot;</span> -i /etc/apt-fast.conf
sed -r <span class="s2">&quot;$ a\$MIRRORS&quot;</span> -i /etc/apt-fast.conf
apt-manager

<span class="c"># Add repositories, browsers</span>
<span class="c"># ###########################</span>

<span class="c"># universe/multiverse repositories</span>
apt-add-repository <span class="s2">&quot;deb http://archive.ubuntu.com/ubuntu $(lsb_release -sc) main universe restricted multiverse&quot;</span>

<span class="c"># add repositories for: Cinelerra, Ubuntu tweaks, Rails</span>
<span class="c"># REPOS=&#39;ppa:cinelerra-ppa/ppa ppa:tualatrix/ppa ppa:ubuntu-on-rails/ppa&#39;</span>
<span class="c"># apt-repos</span>

<span class="c"># upgrade Firefox, replace latex-xft-fonts with ttf-lyx, add curl for Chrome</span>
<span class="nv">PKGS</span><span class="o">=</span><span class="s1">&#39;curl firefox ttf-lyx ubufox&#39;</span>
apt-pkgs

<span class="c"># install Google Chrome stable</span>
<span class="k">if </span><span class="nb">echo</span> <span class="sb">`</span>uname -i<span class="sb">`</span> | grep -q 64 ; <span class="k">then</span>
<span class="k">  </span><span class="nv">CHROMEVER</span><span class="o">=</span><span class="s2">&quot;google-chrome-stable_current_amd64.deb&quot;</span>
<span class="k">else</span>
<span class="k">  </span><span class="nv">CHROMEVER</span><span class="o">=</span><span class="s2">&quot;google-chrome-stable_current_i386.deb&quot;</span>
<span class="k">fi</span>
wget -O /tmp/chrome.deb https://dl-ssl.google.com/linux/direct/<span class="nv">$CHROMEVER</span>
dpkg -i /tmp/chrome.deb
rm /tmp/chrome.deb

<span class="c"># Install apps and tools</span>
<span class="c"># ###########################</span>

  <span class="c"># install desktop productivity apps</span>
<span class="nv">PKGS</span><span class="o">=</span><span class="s1">&#39;blender dia filezilla freemind gimp gnucash inkscape mypaint&#39;</span>
PKGS+<span class="o">=</span><span class="s1">&#39; openshot scribus shotwell xaralx xsane&#39;</span>
<span class="c"># PKGS+=&#39; cinelerra&#39;</span>
apt-pkgs

<span class="c"># install desktop utility apps</span>
<span class="nv">PKGS</span><span class="o">=</span><span class="s1">&#39;aptitude byobu cifs-utils diffuse dosbox dosemu&#39;</span>
PKGS+<span class="o">=</span><span class="s1">&#39; hplip-gui keepassx krdc kubuntu-restricted-extras lftp mc&#39;</span>
PKGS+<span class="o">=</span><span class="s1">&#39; nfs-common openvpn plasma-widget-lancelot putty recordmydesktop&#39;</span> 
PKGS+<span class="o">=</span><span class="s1">&#39; screen shutter unison vlc whois wine wireshark xclip&#39;</span>
<span class="c"># PKGS+=&#39; playonlinux ubuntu-tweak&#39;</span>
apt-pkgs

<span class="c"># install Sun (Oracle) java</span>
<span class="nv">PKGS</span><span class="o">=</span><span class="s1">&#39;sun-java6-bin sun-java6-fonts sun-java6-javadb sun-java6-jdk&#39;</span>
PKGS+<span class="o">=</span><span class="s1">&#39; sun-java6-jre sun-java6-plugin&#39;</span>
apt-pkgs

<span class="c"># install playonlinux windows game console</span>
<span class="c"># wget -q &quot;http://deb.playonlinux.com/public.gpg&quot; -O- | apt-key add -</span>
<span class="c"># wget http://deb.playonlinux.com/playonlinux_trusty.list -O /etc/apt/sources.list.d/playonlinux.list</span>
<span class="c"># $APTMGR update</span>
<span class="c"># $APTMGR install playonlinux</span>

<span class="c"># clean up aptitude at end</span>
<span class="c"># ###########################</span>

<span class="nv">$APTMGR</span> clean <span class="o">&amp;&amp;</span> <span class="nv">$APTMGR</span> update <span class="o">&amp;&amp;</span> <span class="nv">$APTMGR</span> upgrade

<span class="c"># Restart system</span>
<span class="c"># ###########################</span>

reboot

<span class="c">################################################################################</span>

<span class="c"># 10/12/14 GARL -- Added apt-fast installation to speed routine</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="07_lesson3.html" title="Exercise 3: Automation Script"
             >previous</a></li>
        <li><a href="index.html">Linux Shell Script Programming 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Gerald Lovel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>